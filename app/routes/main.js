const express = require('express');
const router = express.Router();
const getPred = require('./getPred');
  

router.get('/', (req, res, next) => {
  res.render('index.ejs', {
    prods: "hello",
    pageTitle: 'MegNav',
    path: '/',
    hasProducts: 1,
    activeShop: true,
    productCSS: true,
    onPredict: 0
  });
});

router.get('/docs', (req, res, next) => {
  res.render('docs.ejs', {
    prods: "hello",
    pageTitle: 'MegNav',
    path: '/docs',
    hasProducts: 1,
    activeShop: true,
    productCSS: true
  });
});

router.post('/predict',  async function (req, res, next) {
  const myjson = await getPred.getPred();
  console.log(myjson);
  console.log("Final", myjson.predict);
  res.render('print.ejs', {
    prods: myjson.predict,
    pageTitle: 'MegNav',
    path: '/',
    hasProducts: 1,
    activeShop: true,
    productCSS: true,
    onPredict: 1 
  });
  console.log(myjson.predict);
});

module.exports = router;
